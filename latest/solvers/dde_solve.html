<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>DDE Solvers · DifferentialEquations.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../index.html"><img class="logo" src="../assets/logo.png" alt="DifferentialEquations.jl logo"/></a><h1>DifferentialEquations.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" action="../search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../index.html">Home</a></li><li><span class="toctext">Tutorials</span><ul><li><a class="toctext" href="../tutorials/ode_example.html">Ordinary Differential Equations</a></li><li><a class="toctext" href="../tutorials/sde_example.html">Stochastic Differential Equations</a></li><li><a class="toctext" href="../tutorials/rode_example.html">Random Ordinary Differential Equations</a></li><li><a class="toctext" href="../tutorials/dde_example.html">Delay Differential Equations</a></li><li><a class="toctext" href="../tutorials/dae_example.html">Differential Algebraic Equations</a></li><li><a class="toctext" href="../tutorials/discrete_stochastic_example.html">Discrete Stochastic (Gillespie) Equations</a></li><li><a class="toctext" href="../tutorials/jump_diffusion.html">Jump Diffusion Equations</a></li><li><a class="toctext" href="../tutorials/fempoisson_example.html">Poisson Equation Finite Element Method</a></li><li><a class="toctext" href="../tutorials/femheat_example.html">Heat Equation Finite Element Method</a></li><li><a class="toctext" href="../tutorials/femstochastic_example.html">Stochastic Finite Element Method</a></li></ul></li><li><span class="toctext">Basics</span><ul><li><a class="toctext" href="../basics/overview.html">Overview of DifferentialEquations.jl</a></li><li><a class="toctext" href="../basics/common_solver_opts.html">Common Solver Options</a></li><li><a class="toctext" href="../basics/solution.html">Solution Handling</a></li><li><a class="toctext" href="../basics/plot.html">Plot Functions</a></li><li><a class="toctext" href="../basics/integrator.html">Integrator Interface</a></li><li><a class="toctext" href="../basics/compatibility_chart.html">Solver Compatibility Chart</a></li></ul></li><li><span class="toctext">Problem Types</span><ul><li><a class="toctext" href="../types/discrete_types.html">Discrete Problems</a></li><li><a class="toctext" href="../types/ode_types.html">ODE Problems</a></li><li><a class="toctext" href="../types/dynamical_types.html">Dynamical, Hamiltonian and 2nd Order ODE Problems</a></li><li><a class="toctext" href="../types/split_ode_types.html">Split ODE Problems</a></li><li><a class="toctext" href="../types/steady_state_types.html">Steady State Problems</a></li><li><a class="toctext" href="../types/bvp_types.html">BVP Problems</a></li><li><a class="toctext" href="../types/sde_types.html">SDE Problems</a></li><li><a class="toctext" href="../types/rode_types.html">RODE Problems</a></li><li><a class="toctext" href="../types/dde_types.html">DDE Problems</a></li><li><a class="toctext" href="../types/dae_types.html">DAE Problems</a></li><li><a class="toctext" href="../types/jump_types.html">Jump Problems</a></li><li><a class="toctext" href="../types/fem_types.html">FEM Problems</a></li></ul></li><li><span class="toctext">Solver Algorithms</span><ul><li><a class="toctext" href="discrete_solve.html">Discrete Solvers</a></li><li><a class="toctext" href="ode_solve.html">ODE Solvers</a></li><li><a class="toctext" href="dynamical_solve.html">Dynamical, Hamiltonian, and 2nd Order ODE Solvers</a></li><li><a class="toctext" href="split_ode_solve.html">Split ODE Solvers</a></li><li><a class="toctext" href="steady_state_solve.html">Steady State Solvers</a></li><li><a class="toctext" href="bvp_solve.html">BVP Solvers</a></li><li><a class="toctext" href="sde_solve.html">SDE Solvers</a></li><li><a class="toctext" href="rode_solve.html">RODE Solvers</a></li><li class="current"><a class="toctext" href="dde_solve.html">DDE Solvers</a><ul class="internal"><li><a class="toctext" href="#Recommended-Methods-1">Recommended Methods</a></li><li><a class="toctext" href="#Special-Keyword-Arguments-1">Special Keyword Arguments</a></li></ul></li><li><a class="toctext" href="dae_solve.html">DAE Solvers</a></li><li><a class="toctext" href="fempoisson_solve.html">FEM Poisson Solvers</a></li><li><a class="toctext" href="femheat_solve.html">FEM Heat Solvers</a></li></ul></li><li><span class="toctext">Additional Features</span><ul><li><a class="toctext" href="../features/performance_overloads.html">Performance Overloads</a></li><li><a class="toctext" href="../features/diffeq_arrays.html">DiffEq-Specific Array Types</a></li><li><a class="toctext" href="../features/diffeq_operator.html">DiffEqOperators</a></li><li><a class="toctext" href="../features/noise_process.html">Noise Processes</a></li><li><a class="toctext" href="../features/linear_nonlinear.html">Specifying (Non)Linear Solvers</a></li><li><a class="toctext" href="../features/callback_functions.html">Event Handling and Callback Functions</a></li><li><a class="toctext" href="../features/callback_library.html">Callback Library</a></li><li><a class="toctext" href="../features/monte_carlo.html">Parallel Monte Carlo Simulations</a></li><li><a class="toctext" href="../features/io.html">I/O: Saving and Loading Solution Data</a></li><li><a class="toctext" href="../features/low_dep.html">Low Dependency Usage</a></li><li><a class="toctext" href="../features/mesh.html">Meshes</a></li><li><a class="toctext" href="../features/progress_bar.html">Juno Progress Bar Integration</a></li></ul></li><li><span class="toctext">Analysis Tools</span><ul><li><a class="toctext" href="../analysis/parameterized_functions.html">ParameterizedFunctions</a></li><li><a class="toctext" href="../analysis/parameter_estimation.html">Parameter Estimation</a></li><li><a class="toctext" href="../analysis/bifurcation.html">Bifurcation Analysis</a></li><li><a class="toctext" href="../analysis/sensitivity.html">Sensitivity Analysis</a></li><li><a class="toctext" href="../analysis/uncertainty_quantification.html">Uncertainty Quantification</a></li><li><a class="toctext" href="../analysis/dev_and_test.html">Algorithm Development and Testing</a></li></ul></li><li><span class="toctext">Domain Modeling Tools</span><ul><li><a class="toctext" href="../models/multiscale.html">Multi-Scale Models</a></li><li><a class="toctext" href="../models/physical.html">Physical Models</a></li><li><a class="toctext" href="../models/financial.html">Financial Models</a></li><li><a class="toctext" href="../models/biological.html">Biological Models</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Solver Algorithms</li><li><a href="dde_solve.html">DDE Solvers</a></li></ul><a class="edit-page" href="https://github.com/JuliaDiffEq/DiffEqDocs.jl/tree/9c0c0b5978ef62f150728f508762033c86660fa1/docs/src/solvers/dde_solve.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>DDE Solvers</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="DDE-Solvers-1" href="#DDE-Solvers-1">DDE Solvers</a></h1><p><code>solve(prob::AbstractDDEProblem,alg;kwargs)</code></p><p>Solves the DDE defined by <code>prob</code> using the algorithm <code>alg</code>. If no algorithm is given, a default algorithm will be chosen.</p><h2><a class="nav-anchor" id="Recommended-Methods-1" href="#Recommended-Methods-1">Recommended Methods</a></h2><p>The recommended method for standard constant lag DDE problems are the <code>MethodOfSteps</code> algorithms. These are constructed from an OrdinaryDiffEq.jl algorithm as follows:</p><pre><code class="language-julia">MethodOfSteps(alg;constrained=false,
             fixedpoint_abstol = nothing,
             fixedpoint_reltol = nothing,
             fixedpoint_norm   = nothing,
             max_fixedpoint_iters = 10)</code></pre><p>where <code>alg</code> is an OrdinaryDiffEq.jl algorithm. Most algorithms will work, though a notable exception are algorithms which use a lazy interpolant (the Verner methods).</p><h3><a class="nav-anchor" id="Nonstiff-DDEs-1" href="#Nonstiff-DDEs-1">Nonstiff DDEs</a></h3><p>The standard choice is <code>MethodOfSteps(OrwenZen5())</code>. This is a highly efficient FSAL 5th order algorithm which optimizes its interpolation error and should handle most problems. For fast solving at where non-strict error control is needed, choosing <code>OrwenZen3()</code> can do well. Using <code>BS3</code> is similar to the MATLAB <code>dde23</code>, but <code>OrwenZen3()</code> will have noticably less error for the same work. For algorithms where strict error control is needed, it is recommended that one uses <code>DP8()</code>. Other high order integrators are not applicable since they use a lazy interpolant.</p><p>For state-dependent delays, the current best choice is <code>RK4</code> since it uses a residual control method to more accurately step. Note that current state-dependent delays are not detected and thus non-residual control methods will be less accurate. Still, residual control is an error-prone method. We recommend setting the tolerances low (<code>1e-10</code>) and only trusting the solution to a 2-3 decimal places of accuracy.</p><h3><a class="nav-anchor" id="Stiff-DDEs-and-Differential-Algebraic-Delay-Equations-(DADEs)-1" href="#Stiff-DDEs-and-Differential-Algebraic-Delay-Equations-(DADEs)-1">Stiff DDEs and Differential-Algebraic Delay Equations (DADEs)</a></h3><p>For stiff DDEs, the SDIRK and Rosenbrock methods are very efficient as they will reuse the Jacobian in the unconstrained stepping iterations. One should choose from the methods which have stiff-aware interpolants for better stability. <code>MethodOfSteps(Rosenbrock23())</code> is a good low order method choice. Additionally, the <code>Rodas</code> methods like <code>MethodOfSteps(Rodas4())</code> are good choices because of their higher order stiff-aware interpolant.</p><p>Additionally, DADEs can be solved by specifying the problem in mass matrix form. The Rosenbrock methods are good choices in these situations.</p><h3><a class="nav-anchor" id="Undeclared-Lags-1" href="#Undeclared-Lags-1">Undeclared Lags</a></h3><p>Lags are declared separately from their use. One can use any lag by simply using the interpolant of <code>h</code> at that point. However, one should use caution in order to achieve the best accuracy. When lags are declared, the solvers can more efficiently be more accurate. If there are undeclared lags, one should only use residual control methods like <code>RK4()</code> as these will better detect the discontinuities.</p><h2><a class="nav-anchor" id="Special-Keyword-Arguments-1" href="#Special-Keyword-Arguments-1">Special Keyword Arguments</a></h2><ul><li><p><code>minimal_solution</code> - Allows the algorithm to delete past history when <code>dense</code> and <code>save_everystep</code> are true. Defaults to true. If lags can grow this may need to be set to false.</p></li></ul><h3><a class="nav-anchor" id="Note-1" href="#Note-1">Note</a></h3><p>If the method is having trouble, one may want to adjust the parameters of the fixed-point iteration. Decreasing the absolute tolerance <code>fixedpoint_abstol</code> and the relative tolerance <code>fixedpoint_reltol</code>, and increasing the maximal number of iterations <code>max_fixedpoint_iters</code> can help ensure that the steps are correct. If the problem still is not correctly converging, one should lower <code>dtmax</code>. In the worst case scenario, one may need to set <code>constrained=true</code> which will constrain timesteps to at most the size of the minimal lag and hence forces more stability at the cost of smaller timesteps.</p><p>There is currently no recommended algorithm for state-dependent delay problems. An algorithm is currently in the works.</p><footer><hr/><a class="previous" href="rode_solve.html"><span class="direction">Previous</span><span class="title">RODE Solvers</span></a><a class="next" href="dae_solve.html"><span class="direction">Next</span><span class="title">DAE Solvers</span></a></footer></article></body></html>
